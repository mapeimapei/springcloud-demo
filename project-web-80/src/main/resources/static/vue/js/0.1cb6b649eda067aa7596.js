webpackJsonp([0],{E3O9:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r("3cXf"),a=r.n(n),s=r("4YfN"),o=r.n(s),i=r("bSIt"),c={name:"products",data:function(){return{productList:[],currentPage:1,pageSize:5}},computed:o()({},Object(i.c)(["user"]),{productList2:function(){var t=(this.currentPage-1)*this.pageSize,e=this.currentPage*this.pageSize;return this.productList.slice(t,e)}}),methods:{makeOrderFn:function(t){var e=this,r={userid:this.user.user_id,productList:[t],fast:"1"},n=this.$loading({lock:!0,background:"rgba(0, 0, 0, 0.5)"});this.$axios.post("shop/order/addOrder",a()(r)).then(function(t){n.close(),t&&"20000"===t.resultCode?(e.$notify({message:"订单生成成功。",type:"success"}),e.$router.push({path:"ordersDetails",query:{orderid:t.result.orderid}})):e.$notify({message:"订单生成失败。",type:"warning"})}).catch(function(t){n.close(),e.$notify({message:"订单生成接口报错。",type:"warning"})})},addShoppingCart:function(t){var e=this,r={productid:t.productid,quantity:t.quantity,userid:this.user.user_id};console.log(r);var n=this.$loading({lock:!0,background:"rgba(0, 0, 0, 0.5)"});this.$axios.post("shop/cart/addCart",a()(r)).then(function(t){n.close(),t&&"20000"===t.resultCode?e.$notify({message:"添加成功。",type:"success"}):e.$notify({message:"添加失败。",type:"warning"})}).catch(function(t){n.close(),e.$notify({message:"添加接口报错。",type:"warning"})})},getProducts:function(){var t=this,e=this.$loading({lock:!0,background:"rgba(0, 0, 0, 0.5)"});this.$axios.get("shop/products").then(function(r){e.close(),r&&"20000"===r.resultCode?(r.result.forEach(function(t,e){t.quantity=1}),t.productList=r.result):t.$notify({message:"获取商品列表失败。",type:"warning"})}).catch(function(r){e.close(),t.$notify({message:"获取商品表接口报错。",type:"warning"})})}},mounted:function(){},created:function(){this.getProducts()}},u=r("W5g0");var l=function(t){r("a+Sf")},d=Object(u.a)(c,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"articleBox fx-f1"},[r("el-table",{staticClass:"articleList",attrs:{data:t.productList2,border:""}},[r("el-table-column",{attrs:{label:"图片",width:"72"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"productIcon"},[r("img",{attrs:{src:t.$ut.srcUrl+e.row.image,sizes:"48"}})])]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"cname",label:"名称"}}),t._v(" "),r("el-table-column",{attrs:{prop:"category",label:"分类"}}),t._v(" "),r("el-table-column",{attrs:{prop:"listprice",label:"单价(￥)"}}),t._v(" "),r("el-table-column",{attrs:{prop:"descn",label:"描述"}}),t._v(" "),r("el-table-column",{attrs:{label:"数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-input-number",{attrs:{min:1,size:"small",label:"描述文字"},model:{value:e.row.quantity,callback:function(r){t.$set(e.row,"quantity",r)},expression:"scope.row.quantity"}})]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"text"},on:{click:function(r){return t.makeOrderFn(e.row)}}},[t._v("直接购买")]),t._v(" "),r("el-button",{attrs:{type:"text"},on:{click:function(r){return t.addShoppingCart(e.row)}}},[t._v("加入购物车")])]}}])})],1),t._v(" "),r("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:"total, prev, pager, next",total:t.productList.length},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1)},[],!1,l,"data-v-7788ce65",null);e.default=d.exports},"a+Sf":function(t,e){}});
//# sourceMappingURL=0.1cb6b649eda067aa7596.js.map